<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8" />
	<title>Shake Moblie</title>
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0" />
	<meta name="author" content="Vitrum.Zhu" />
	<script type="text/javascript" src="js/lib/zepto.min.js"></script>
	<script src="http://222.73.241.58:8081/socket.io/socket.io.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/shake.js"></script>
	<script type="text/javascript">
	function getQueryStringRegExp(name)
	{
		var reg = new RegExp("(^|\\?|&)"+ name +"=([^&]*)(\\s|&|$)", "i");  
		if (reg.test(location.href)) return unescape(RegExp.$2.replace(/\+/g, " ")); return "";
	};
	$(document).ready(function() {
		var theKey = getQueryStringRegExp('key');

		var socket = io.connect("http://222.73.241.58:8081");
		"undefined" != typeof console && console.log("user enter via mobile");

		"undefined" != typeof console && console.log("enter mobile page");
		socket.emit("send", {
			key: theKey,
			act: "enter"
		});

		$("#change_btn").click(function(){
			"undefined" != typeof console && console.log("send change color command");
			socket.emit("send", {
				key: theKey,
				act: "changebg"
			});
		});
		function shakeEventDidOccur () {
			"undefined" != typeof console && console.log("send change color command");
			socket.emit("send", {
				key: theKey,
				act: "changebg"
			});
		}
		function loadPower(secs) {
			secs = Number(secs);
			window.addEventListener('shake', shakeEventDidOccur, false);
            //define a custom method to fire when shake occurs.
            for (var i = secs; i >= 0; i--) {
            	(function(index) {
            		setTimeout(function(){
            			doUpdateTime(index);
            		}, (secs - index) * 1000);
            	})(i);
            }
          }
          loadPower(10);

        });
</script>
</head>
<body>

	<p>双屏互动连接成功！请在电脑屏幕上点击开始！</p>

	<input id="change_btn" type="button" value="晃动屏幕或者按按钮让PC窗口颜色变化" />

</body>
</html>